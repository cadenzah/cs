## Metadata
- 강의명: C/C++/자료구조
- 주제명: 18강 - 전처리기
- 날짜: 2020. 1. 28.

## Index
- 전처리기를 사용하여 효과적으로 프로그램을 작성하는 방법에 대하여 알아보기

## 전처리기란
- 전처리기 구문은 다른 프로그램 영역과 독립적으로 처리된다
  - 프로그램의 전처리 과정에서 사용되는 특별한 문법!
- 전처리기 구문은 **소스코드 파일 단위**로 효력이 존재

## 파일을 포함하는 전처리기
- `#include`는 전처리기 중 가장 많이 사용되는 문법
- 특정 파일을 라이브러리와 같이 포함시키기 위하여 사용된다
  - `#include` 구문이 적힌 부분을 *해당 파일의 내용으로 완전히 대체*한다
- `#include`로 가져올 수 있는 파일에는 제약이 없다


### `#include <파일_이름>`
- 시스템 디렉토리 내에서 해당 파일을 검색한 뒤 가져온다
- 운영체제마다 시스템 디렉토리가 상이
- **시스템 디렉토리에는 `stdio.h`와 같은 헤더 파일들이 존재**한다

### `#include "파일_이름"`
- 현재 실행되는 코드가 존재하는 폴더 내에서 해당 파일을 검색한 뒤 가져온다
  - 현재 폴더에 해당 파일이 없으면 다음으로 시스템 디렉토리를 검색한다

## 나만의 헤더 파일을 만들어보자
1. 소스 코드가 존재하는 동일한 디렉토리에 `temp.h` 라는 파일 생성
2. 다음과 같이 함수 작성
```cpp
int add(int a, int b) {
  return a + b;
}
```
3. 원래 소스 코드 상에서 `#include` 구문 사용하여 불러오기
4. `add`함수를 사용
```cpp
#include <stdio.h>
#include "temp.h"

int main(void) {
  int a = 10, b = 20;
  printf("%d\n", add(a,b));

  return 0;
}
```

- 다만, `#include`는 아무런 유효성 검사 없이 물리적으로 파일 내용을 불러오므로, 여러 번 불러오는 등의 실수를 주의하자

## 메크로 전처리기
- 프로그램 내에서 사용하는 **상수** 및 **함수**를 매크로 형태로 저장하기 위하여 사용된다
- `#define` 문법을 사용
- `#define`은 인자를 받을 수 있다 - 함수로 치환할 수 있도록
    ```cpp
    #define POW(x) (x * x)
    ...
    printf("%d\n", POW(10));
    ```

- `#define`을 사용하면 소스 코드의 길이를 줄여주고 시간을 절약할 수 있다
    ```cpp
    #include <stdio.h>
    #define ll long long
    #define ld long double
    
    int main(void) {
      ll a = 987654221;
      ld b = 100.543;
      printf("%.1f\n", a * b);
      
      return 0;
    }
    ```

## 조건부 컴파일
- 컴파일이 이루어지는 영역을 지정해줄 수 있다
- 일반적으로 디버깅, 이식 용도로 사용
  - 시스템 프로그래밍시, 운영체제에 따라 별도의 소스코드를 사용해야 하는 경우

### `#ifndef ~ #endif`
- 특정한 매크로가 정의되어있지 않다면, 다음의 내용을 실행하겠다
- 헤더 파일이 중복되어 사용되지 않도록 하기 위하여 사용
    ```cpp
    // temp.h
    #ifnedf _TEMP_H_ // _TEMP_H_가 정의되지 않았을 경우에만 #endif 전까지 실행
    #define _TEMP_H_ // 이 함수가 한번이라도 실행되면, 반드시 이 매크로가 정의된다
    int add (int a, int b) {
      return a + b;
    }
    #endif
    ```

## 파일 분할 컴파일
- 일반적으로 직접 라이브러리를 만들 때에는 `.c` 파일과 `.h` 파일을 모두 작성해야 한다
    ```cpp
    // temp.h
    #ifndef _TEMP_H_
    #define _TEMP_H_
    int add(int a, int b);
    #endif

    // temp.c
    #include "temp.h"
    int add(int a, int b) {
      return a + b;
    }
    ```

- 위와 같이, 함수의 실제 구현(원형)과 시그니처(형태)를 나누어서 정의
- `temp.h`만을 불러오면, `temp.c`는 자동으로 사용된다
 